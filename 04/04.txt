04.txt

十一.

5.类型失衡问题
在分类过程中,哪些样本你离明显偏多的类别更有机会被分类器作为预测结果,从而导致较大的误差.支持向量机分类器通过为不同比例的类别分配不同的权重,来平衡他们在分类过程中的作用,尽可能做到公平.
model = svm.SVC(kernel='linear', class_weight='balanced',...)
代码:svm_bal.py

6.置信概率
支持向量机分类器是依据分类边界线的位置计算每个样本的置信概率的,那些距离边界线较近的样本,置信概率就较低,反之较高.
model = svm.SVC(..., probability=True, ...)
...
model.predict(输入集)->预测输出
model.predict_proba(输入集)->置信概率
                  预测输出   置信概率
                0   1    2    3
输入样本1  0    0.9 0.2 0.1 0.4
输入样本2  1    0.2 0.5 0.1 0.3
输入样本3  3    0.3 0.4 0.6 0.7
输入样本4  2    0.2 0.1 0.3 0.2
...                             ...
代码：svm_prob.py

7.网格搜索
针对不同超参数的组合,来进行多次交叉验证,从中选择性能指标最好的参数组合来构建模型对象.
ms.GridSearchCV(模型对象,超参数列表,cv=验证次数)->最优模型对象
代码:svm_grid.py

8.事件预测案例
代码:svm_evt.py


9.交通流量预测案例
代码:svm_trf.py


十二.无监督学习
聚类
1.k均值算法
欧几里得距离:
一维空间:x1,x2->|x1-x2|,sqrt((x1-x2)^2)
二维空间:(x1,y1),(x2,y2)->sqrt((x1-x2)^2+(y1-y2)^2)
三维空间:(x1,y1,z1),(x2,y2,z3),(x3,y3,z3)->sqrt((x1-x2)^2+(y1-y2)^2+(z1-z2)^2)
N维空间:(x1,x2,..xn),(x1',x2'...xn')->sqrt((x1-x1')^2+(x2-x2')^2+...(xn-xn')^2)
第一步:随机选择k个样本作为聚类中心;
第二步:遍历除中心以外的样本,计算他们与每个聚类中心的欧氏距离,选择距离最近中心的类别作为该样本的类别,完成一次聚类划分;
第三部:针对每一个已划分好的聚类,计算他们的几何中心,将该几何中心作为新的聚类中心,重复第二步,再次进行聚类划分,直到某次聚类划分之后所得到的集合中心与有依据的聚类中心重合或足够接近为止.
代码:km.py
利用K均值聚类量化图像
代码:quant.py
2.均值漂移算法
将带划分聚类的样本集合看做服从某种概率规则的随机分布,通过多次迭代,找到与样本奶粉不直方图具有最佳拟合形态的概率模式,即最优概率密度函数,该函数的峰值位置即聚类中心,而后再根据每个样本努力聚类中心的距离远近划分不同的聚类
代码:shift.py
3.凝聚层次算法
首先将每个样本看做一个独立的集群，如果聚类数大于事先给定值,则根据距离远近有每个样本能出发凝聚与之最近的样本形成新的更大的集群,不断扩大集群的规模,同时缩减集群的数量,直到达到给定值为止,这样得到的每个集群即最终划分的聚类.
代码：agglo.py

除了根据距离以外还可以 根据连续性选择被凝聚的样本.
代码:spiral.py

4.评价指标
评价一个聚类模型的性能,关注它是否体现了内密外疏的原则.
一个样本的轮廓系数=(b-a)/max(a,b)
a:该样本与同距离其它样本的平均距离
b:该样本与和它距离最近的另一个聚类中各样本的距离
整个模型的轮廓系数=所有样本的轮廓系数的算数平均值
-1 <- 0 ->1
差  重叠 优
sm.silhouette_score(输入集,预测类别,样本数,metric=距离种类)->轮廓系数
代码:score.py

5.DBSCAN(噪声密度)算法
从待聚类样本中随机选择一个样本,以预先给定的'半径'做'圆',所有被该圆圈中的样本内视为与所选样本同类,在以这些被权重样本为中心做圆重复以上过程,不断增加聚类的成员,直到没有新的成员加入位置,即完成了一个聚类的划分.而后,在从其余样本中随机选择一个重复以上过程,直至好近所有样本为止.
外周样本:位于某个样本的扩展范围内,但却无法扩展出新的成员.
孤立样本:既不能被任何样本扩展为聚类成员,同时也无法引入其它成员组成聚类.
核心样本:除了外周样本和孤立样本以外的都属于核心样本.
